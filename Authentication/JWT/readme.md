# Web API with JWT Token

JWTs in .NET Core are used for authentication and authorization. They consist of three parts: a header, a payload, and a signature. The header contains information about the type of token and the algorithm used for signing. The payload contains the claims or attributes associated with the user or application. Finally, the signature is generated by signing the header and payload using a secret key.

## Required Authentication/Authorization Elements

### `.AddAuthentication()`
The `AddAuthentication` method is used to add authentication services to the DI container. This method is called from the `ConfigureServices` method in the `Startup` class. It sets up the default scheme that will be used by the application.

### `.AddJwtBearer()`
The `AddJwtBearer` method is an extension method that configures JWT Bearer authentication. It is used to add and configure JWT Bearer authentication services. You can use this method to set various options like the authority, audience, and token validation parameters.

### `.AddAuthorization()`
The `AddAuthorization` method adds authorization services to the DI container. This method is also called from the `ConfigureServices` method in the `Startup` class. It allows you to define various authorization policies.

## Handling the Token in the Request
Once a JWT token is created, it can be sent back to the client. From then on, the client attaches the JWT token to each request it sends to the server. The server authorizes the JWT token and continues processing the request. The `AddAuthentication`, `AddJwtBearer`, and `AddAuthorization` methods play a crucial role in this process.

## Running the Example
This example takes the boilerplate "weatherforecast" Web API example and adds authentication and authorization by means of validating a JWT token with specific claims. 

```shell
# run the application
dotnet run

# (in separate shell)
curl http://localhost:5154/weatherforecast -v -H "Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IlJ5YW4iLCJwb3NpdGlvbiI6InRlYWNoZXIiLCJpYXQiOjE1MTYyMzkwMjJ9.i3eWEwxThXYTnahJpynfdkQR6dvjvgJBa-uXSJX5eNk"
```